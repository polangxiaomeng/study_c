> **ğŸ•åšå®¢ä¸»é¡µï¼šï¸[è‡ªä¿¡ä¸å­¤å•](https://blog.csdn.net/czh1592272237)**
>
> **ğŸ¬æ–‡ç« ä¸“æ ï¼š[Cè¯­è¨€](https://blog.csdn.net/czh1592272237/category_12209876.html)**
>
> **ğŸšä»£ç ä»“åº“ï¼š[ç ´æµªæ™“æ¢¦](https://gitee.com/polang-xiaomeng/study_c)**
>
> **ğŸ­æ¬¢è¿å…³æ³¨ï¼šæ¬¢è¿å¤§å®¶ç‚¹èµæ”¶è—+å…³æ³¨**

# é€šè®¯å½•â€”â€”åŠ¨æ€ç‰ˆ

[toc]

---

# å‰è¨€

> **æ¸©é¦¨æç¤ºï¼š**
> **==å¤§å®¶åœ¨çœ‹è¿™ç¯‡æ–‡ç« å‰ï¼Œè¯·å…ˆçœ‹å®Œä¸Šä¸€ç¯‡æ–‡ç« [é€šè®¯å½•â€”â€”é™æ€ç‰ˆ](https://blog.csdn.net/czh1592272237/article/details/129774050?spm=1001.2014.3001.5501)ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯å¯¹ä¸Šä¸€ç¯‡æ–‡ç« æ‰€å®ç°é™æ€ç‰ˆé€šè®¯å½•çš„å‡çº§ã€‚==**

> åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†é€šè®¯å½•çš„é™æ€ç‰ˆæœ¬ã€‚æˆ‘ä»¬å‘ç°é™æ€é€šè®¯å½•å­˜åœ¨çš„ä¸€ä¸ªæœ€å¤§é—®é¢˜å°±æ˜¯æ— æ³•è‡ªåŠ¨æ‰©å®¹ï¼Œå½“ä¿¡æ¯å­˜æ»¡äº†ï¼Œå°±æ— æ³•ç»§ç»­æ·»åŠ è”ç³»äººã€‚å°±æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯¹ä¹‹å‰çš„é™æ€ç‰ˆæœ¬å‡çº§ä¸ºåŠ¨æ€ç‰ˆæœ¬ã€‚

# å¯¹é™æ€ç‰ˆçš„ä¿®æ”¹

## 1. é€šè®¯å½•ç»“æ„ä½“çš„å£°æ˜

==é™æ€ç‰ˆæœ¬ï¼š==

```c
typedef struct Contact
{
	PeopleInfo data[MAX];//å®šä¹‰æ•°ç»„ç”¨æ¥å­˜æ”¾è”ç³»äººä¿¡æ¯
	int sz;//è®°å½•é€šè®¯å½•ä¸­æœ‰æ•ˆä¿¡æ¯çš„ä¸ªæ•°
}Contact;
```

==åŠ¨æ€ç‰ˆæœ¬ï¼š==

```c
typedef struct Contact
{
	PeopleInfo* data;//dataæŒ‡å‘å­˜æ”¾æ•°æ®çš„ç©ºé—´
	int sz;//è®°å½•é€šè®¯å½•ä¸­æœ‰æ•ˆä¿¡æ¯çš„ä¸ªæ•°
	int capacity;//è®°å½•é€šè®¯å½•å½“å‰çš„å®¹é‡
}Contact;
```

> è¿™é‡Œå°†å›ºå®šå¤§å°çš„PeopleInfoç±»å‹çš„æ•°ç»„æ”¹ä¸ºäº†PeopleInfo*ç±»å‹çš„æŒ‡é’ˆï¼Œç”¨capacityæ¥è®°å½•æŒ‡é’ˆæŒ‡å‘çš„åŠ¨æ€å¼€è¾Ÿç©ºé—´æ‰€èƒ½å®¹çº³çš„å…ƒç´ ä¸ªæ•°ã€‚

## 2. åˆå§‹åŒ–é€šè®¯å½•

==é™æ€ç‰ˆæœ¬ï¼š==

```c
void InitContact(Contact* pc)
{
	pc->sz = 0;
	memset(pc->data, 0, sizeof(pc->data));
}
```

==åŠ¨æ€ç‰ˆæœ¬ï¼š==

```c
void InitContact(Contact* pc)
{
	pc->data = (PeopleInfo*)calloc(DEFAULT_SZ, sizeof(PeopleInfo));
	if (pc->data == NULL)
	{
		perror("åˆå§‹åŒ–å¤±è´¥");
		return;
	}
	pc->sz = 0;
	pc->capacity = DEFAULT_SZ;
}
```

> - è¿™é‡Œä½¿ç”¨callocå‡½æ•°åœ¨å †åŒºåŠ¨æ€å¼€è¾Ÿä¸€å—ç©ºé—´ï¼Œå¹¶åˆå§‹åŒ–ä¸º0ã€‚
> - åœ¨contact.hå¤´æ–‡ä»¶ä¸­å®å®šä¹‰äº†DEFAYLT_SZå¸¸é‡è¡¨ç¤ºé»˜è®¤å¼€è¾Ÿå…ƒç´ ä¸ªæ•°ï¼Œåœ¨æ­¤å®šä¹‰DEFAYLT_SZçš„å€¼ä¸º3ã€‚
> - è‹¥å¼€è¾Ÿå¤±è´¥ï¼Œåˆ™æ˜¾ç¤ºå¤±è´¥ä¿¡æ¯ã€‚
> - æŠŠå®¹é‡capacityç½®ä¸ºé»˜è®¤å…ƒç´ ä¸ªæ•°DEFAYLT_SZã€‚

## 3. æ·»åŠ è”ç³»äºº

==é™æ€ç‰ˆæœ¬ï¼š==

```c
void Add(Contact* pc)
{
	if (pc->sz == MAX)
	{
		printf("é€šè®¯å½•å·²æ»¡ï¼Œæ— æ³•ç»§ç»­å¡«å…¥ä¿¡æ¯\n");
		return;
	}
	printf("è¯·è¾“å…¥å§“å:>");
	scanf("%s", pc->data[pc->sz].name);
	printf("è¯·è¾“å…¥æ€§åˆ«:>");
	scanf("%s", pc->data[pc->sz].sex);
	printf("è¯·è¾“å…¥å¹´é¾„:>");
	scanf("%d", &(pc->data[pc->sz].age));
	printf("è¯·è¾“å…¥ç”µè¯å·:>");
	scanf("%s", pc->data[pc->sz].tele);
	printf("è¯·è¾“å…¥ä½å€:>");
	scanf("%s", pc->data[pc->sz].addr);
	pc->sz++;
	printf("æ·»åŠ æˆåŠŸ\n");
}
```

==åŠ¨æ€ç‰ˆæœ¬ï¼š==

```c
static int CheckCapacity(Contact* pc)
{
	if (pc->sz == pc->capacity)
	{
		PeopleInfo* str = (PeopleInfo*)realloc(pc->data, (pc->capacity + INC_SZ) * sizeof(PeopleInfo));
		if (str != NULL)
		{
			pc->data = str;
			pc->capacity += INC_SZ;
		}
		else
		{
			printf("å†…å­˜ä¸è¶³ï¼Œé€šè®¯å½•æ‰©å®¹å¤±è´¥\n");
			return -1;
		}
		printf("é€šè®¯å½•æ‰©å®¹æˆåŠŸï¼Œå½“å‰å®¹é‡ä¸º%d\n", pc->capacity);
	}
	return 1;
}

void Add(Contact* pc)
{
	if (CheckCapacity(pc) == -1)
	{
		return;
	}
	printf("è¯·è¾“å…¥å§“å:>");
	scanf("%s", pc->data[pc->sz].name);
	printf("è¯·è¾“å…¥æ€§åˆ«:>");
	scanf("%s", pc->data[pc->sz].sex);
	printf("è¯·è¾“å…¥å¹´é¾„:>");
	scanf("%d", &(pc->data[pc->sz].age));
	printf("è¯·è¾“å…¥ç”µè¯å·:>");
	scanf("%s", pc->data[pc->sz].tele);
	printf("è¯·è¾“å…¥ä½å€:>");
	scanf("%s", pc->data[pc->sz].addr);
	pc->sz++;
	printf("æ·»åŠ æˆåŠŸ\n");
}
```

> åœ¨åŠ¨æ€ç‰ˆæœ¬ä¸­ï¼Œå°è£…äº†ä¸€ä¸ªcheck_capacityå‡½æ•°ï¼Œä¸“é—¨ç”¨äºæ£€æŸ¥é€šè®¯å½•æ˜¯å¦æ»¡é¢ï¼Œå¦‚æœæ»¡äº†å°±ä¼šè‡ªåŠ¨æ‰©å®¹é€šè®¯å½•ï¼Œæ¯æ¬¡æ‰©å®¹å¢åŠ INC_SZï¼ˆå®å®šä¹‰æ­¤å¤„å€¼ä¸º5ï¼‰ä¸ªå…ƒç´ çš„ç©ºé—´ ã€‚

**==æ³¨æ„ï¼š==**

> ä½¿ç”¨reallocå‡½æ•°æ—¶ï¼Œä¸èƒ½ç›´æ¥ç”¨dataæ¥æ¥æ”¶reallocå‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœå¼€è¾Ÿç©ºé—´å¤±è´¥ï¼Œé‚£ä¹ˆåŸå…ˆdataæ‰€æŒ‡å‘çš„ç©ºé—´å°±ä¼šä¸¢å¤±ã€‚å› æ­¤ï¼Œéœ€è¦ä¸€ä¸ªä¸´æ—¶å˜é‡æ¥æ¥æ”¶ï¼Œåˆ¤æ–­ç©ºé—´å¼€è¾ŸæˆåŠŸåï¼Œå†è®©dataæŒ‡å‘è¿™å—ç©ºé—´ã€‚

## 4. é”€æ¯é€šè®¯å½•

```c
void Destroy(Contact* pc)
{
	free(pc->data);
	pc->data = NULL;
	pc->capacity = 0;
	pc->sz = 0;
	printf("é‡Šæ”¾å†…å­˜æˆåŠŸ\n");
}
```

> åœ¨åŠ¨æ€é€šè®¯å½•ä¸­ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨å®Œå †ä¸Šå¼€è¾Ÿçš„ç©ºé—´åéœ€è¦ä¸»åŠ¨å»é‡Šæ”¾ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚è¦å®ç°æ­¤åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨freeé‡Šæ”¾æ‰ç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿè¦å°†æŒ‡é’ˆç½®ç©ºã€‚ 

==è¿™å°±æ˜¯åŠ¨æ€ç‰ˆæœ¬é€šè®¯å½•çš„å®ç°ï¼Œå…¶ä»–å‡½æ•°åŠŸèƒ½å®ç°åŒé™æ€ç‰ˆé€šè®¯å½•ã€‚==

# å®Œæ•´æºç 

==tect.cæ–‡ä»¶==

```c
#define _CRT_SECURE_NO_WARNINGS 1

#include "contact.h"

enum Optition
{
	EXIT,
	ADD,
	DEL,
	SEARCH,
	MODIFY,
	SHOW,
	SORT
};

static void menu()
{
	printf("********************************\n");
	printf("***    1. add     2. del     ***\n");
	printf("***    3. search  4. modify  ***\n");
	printf("***    5. show    6. sort    ***\n");
	printf("***    0. exit               ***\n");
	printf("********************************\n");
}



int main()
{

	int input = 0;
	Contact con;
	//åˆå§‹åŒ–é€šè®¯å½•
	InitContact(&con);
	do
	{
		menu();
		printf("è¯·è¾“å…¥æ“ä½œé€‰é¡¹:>");
		scanf("%d", &input);
		switch (input)
		{
		case ADD:
			Add(&con);
			break;
		case DEL:
			Del(&con);
			break;
		case SEARCH:
			Search(&con);
			break;
		case MODIFY:
			Modify(&con);
			break;
		case SHOW:
			Show(&con);
			break;
		case SORT:
			Sort(&con);
			break;
		case EXIT:
			Destroy(&con);
			printf("é€€å‡ºé€šè®¯å½•\n");
			break;
		default:
			printf("é€‰æ‹©é”™è¯¯\n");
			break;
		}
	} while (input);

	return 0;
}
```

==contact.hæ–‡ä»¶==

```c
#pragma once

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define MAX_NAME 20
#define MAX_SEX 5
#define MAX_TELE 12
#define MAX_ADDR 40
#define DEFAULT_SZ 3    //é»˜è®¤å¤§å°
#define INC_SZ 5    //æ‰©å®¹å¤§å°

//æè¿°ä¸€ä¸ªäººçš„ä¿¡æ¯
typedef struct PeopleInfo
{
	char name[MAX_NAME];
	char sex[MAX_SEX];
	int age;
	char tele[MAX_TELE];
	char addr[MAX_ADDR];
}PeopleInfo;

//é€šè®¯å½•
typedef struct Contact
{
	PeopleInfo* data;//dataæŒ‡å‘å­˜æ”¾æ•°æ®çš„ç©ºé—´
	int sz;//è®°å½•é€šè®¯å½•ä¸­æœ‰æ•ˆä¿¡æ¯çš„ä¸ªæ•°
	int capacity;//è®°å½•é€šè®¯å½•å½“å‰çš„å®¹é‡
}Contact;

//åˆå§‹åŒ–é€šè®¯å½•
void InitContact(Contact* pc);
//æ·»åŠ è”ç³»äººä¿¡æ¯
void Add(Contact* pc);
//åˆ é™¤è”ç³»äººä¿¡æ¯
void Del(Contact* pc);
//æ˜¾ç¤ºè”ç³»äººä¿¡æ¯
void Show(Contact* pc);
//æŸ¥æ‰¾è”ç³»äººä¿¡æ¯
void Search(const Contact* pc);
//ä¿®æ”¹è”ç³»äººä¿¡æ¯
void Modify(Contact* pc);
//æŒ‰åå­—æ’åºé€šè®¯å½•
void Sort(Contact* pc);
//é”€æ¯é€šè®¯å½•
void Destroy(Contact* pc);
```

==contact.cæ–‡ä»¶==

```c
#define _CRT_SECURE_NO_WARNINGS 1

#include "contact.h"

void InitContact(Contact* pc)
{
	pc->data = (PeopleInfo*)calloc(DEFAULT_SZ, sizeof(PeopleInfo));
	if (pc->data == NULL)
	{
		perror("åˆå§‹åŒ–å¤±è´¥");
		return;
	}
	pc->sz = 0;
	pc->capacity = DEFAULT_SZ;
}

void Destroy(Contact* pc)
{
	free(pc->data);
	pc->data = NULL;
	pc->capacity = 0;
	pc->sz = 0;
	printf("é‡Šæ”¾å†…å­˜æˆåŠŸ\n");
}


static int CheckCapacity(Contact* pc)
{
	if (pc->sz == pc->capacity)
	{
		PeopleInfo* str = (PeopleInfo*)realloc(pc->data, (pc->capacity + INC_SZ) * sizeof(PeopleInfo));
		if (str != NULL)
		{
			pc->data = str;
			pc->capacity += INC_SZ;
		}
		else
		{
			printf("å†…å­˜ä¸è¶³ï¼Œé€šè®¯å½•æ‰©å®¹å¤±è´¥\n");
			return -1;
		}
		printf("é€šè®¯å½•æ‰©å®¹æˆåŠŸï¼Œå½“å‰å®¹é‡ä¸º%d\n", pc->capacity);
	}
	return 1;
}

void Add(Contact* pc)
{
	if (CheckCapacity(pc) == -1)
	{
		return;
	}
	printf("è¯·è¾“å…¥å§“å:>");
	scanf("%s", pc->data[pc->sz].name);
	printf("è¯·è¾“å…¥æ€§åˆ«:>");
	scanf("%s", pc->data[pc->sz].sex);
	printf("è¯·è¾“å…¥å¹´é¾„:>");
	scanf("%d", &(pc->data[pc->sz].age));
	printf("è¯·è¾“å…¥ç”µè¯å·:>");
	scanf("%s", pc->data[pc->sz].tele);
	printf("è¯·è¾“å…¥ä½å€:>");
	scanf("%s", pc->data[pc->sz].addr);
	pc->sz++;
	printf("æ·»åŠ æˆåŠŸ\n");
}

void Show(Contact* pc)
{
	if (pc->sz == 0)
	{
		printf("é€šè®¯å½•ä¸ºç©º\n");
		return;
	}
	printf("%-20s%-10s%-20s%-20s%-30s\n", "å§“å", "æ€§åˆ«", "å¹´é¾„", "ç”µè¯", "åœ°å€");
	for (int i = 0; i < pc->sz; i++)
	{
		printf("%-20s%-10s%-20d%-20s%-30s\n",
			pc->data[i].name, pc->data[i].sex,
			pc->data[i].age, pc->data[i].tele, pc->data[i].addr);
	}
}

//æŸ¥æ‰¾è”ç³»äººå§“å
static int Find(const Contact* pc, const char name[])
{
	int i = 0;
	for (i = 0; i < pc->sz; i++)
	{
		if (strcmp(name, pc->data[i].name) == 0)
		{
			return i;
		}
	}
	return -1;
}

void Del(Contact* pc)
{
	char name[MAX_NAME] = {0};
	int ret = 0, i = 0;
	printf("è¯·è¾“å…¥è¦åˆ é™¤äººçš„å§“å:>");
	scanf("%s", name);
	ret = Find(pc, name);
	if (ret == -1)
	{
		printf("åˆ é™¤å¤±è´¥ï¼Œè¯¥è”ç³»äººä¸å­˜åœ¨\n");
		return;
	}
	else
	{
		for (i = ret; i < pc->sz-1; i++)
		{
			pc->data[i] = pc->data[i + 1];
		}
		pc->sz--;
		printf("åˆ é™¤æˆåŠŸ\n");
	}
}


void Search(const Contact* pc)
{
	char name[MAX_NAME] = { 0 };
	int ret = 0;
	printf("è¯·è¾“å…¥è¦æŸ¥æ‰¾äººçš„åå­—:>");
	scanf("%s", name);
	ret = Find(pc, name);
	if (ret == -1)
	{
		printf("è¯¥è”ç³»äººä¸å­˜åœ¨\n");
		return;
	}
	else
	{
		printf("%-20s%-10s%-20s%-20s%-30s\n", "å§“å", "æ€§åˆ«", "å¹´é¾„", "ç”µè¯", "åœ°å€");
		printf("%-20s%-10s%-20d%-20s%-30s\n", pc->data[ret].name, pc->data[ret].sex,
			pc->data[ret].age, pc->data[ret].tele, pc->data[ret].addr);
	}
}

void Modify(Contact* pc)
{
	char name[MAX_NAME] = { 0 };
	int ret = 0;
	printf("è¯·è¾“å…¥è¦ä¿®æ”¹äººçš„å§“å:>");
	scanf("%s", name);
	ret = Find(pc, name);
	if (ret == -1)
	{
		printf("è¯¥è”ç³»äººä¸å­˜åœ¨\n");
		return;
	}
	else
	{
		printf("è¯·è¾“å…¥å§“å:>");
		scanf("%s", pc->data[ret].name);
		printf("è¯·è¾“å…¥æ€§åˆ«:>");
		scanf("%s", pc->data[ret].sex);
		printf("è¯·è¾“å…¥å¹´é¾„:>");
		scanf("%d", &(pc->data[ret].age));
		printf("è¯·è¾“å…¥ç”µè¯å·:>");
		scanf("%s", pc->data[ret].tele);
		printf("è¯·è¾“å…¥ä½å€:>");
		scanf("%s", pc->data[ret].addr);
		printf("ä¿®æ”¹æˆåŠŸ\n");
	}
}

int compare_name(const void* p1, const void* p2)
{
	return strcmp(((PeopleInfo*)p1)->name, ((PeopleInfo*)p2)->name);
}

void Sort(Contact* pc)
{
	qsort(pc->data, pc->sz, sizeof(PeopleInfo), compare_name);
	printf("æ’åºæˆåŠŸ\n");
}
```

==åˆ°æ­¤ï¼Œå…³äºã€Šé€šè®¯å½•â€”â€”åŠ¨æ€ç‰ˆã€‹çš„å†…å®¹å°±ç»“æŸäº†
æ„Ÿè°¢å¤§å®¶çš„è§‚çœ‹
åˆ›ä½œä¸æ˜“ï¼Œå¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ä¸€é”®ä¸‰è¿
æ‚¨çš„æ”¯æŒå°±æ˜¯æˆ‘åˆ›ä½œæœ€å¤§çš„åŠ¨åŠ›ï¼ï¼ï¼==